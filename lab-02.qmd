---
title: "Lab 2 - Data wrangling"
author: "John Q. Student"
date: "June 24, 1497"
format: 
  html: default # for speed
  pdf: default # for final output
---

```{r}
#| eval: true
#| message: false

library(tidyverse)
```

# Questions

## Part 1

### Question 1

```{r}
#| label: Question 1

midwest |>
  select(state,county) |>
  count(state) |>
  arrange(desc(n))

```

Home to 102 counties, Illinois has the most counties. While Wisconsin has the least with only 72 counties.

### Question 2

```{r}

midwest |>
  select(state, county) |>
  count(county) |>
  arrange(desc(n)) |>
  filter(n == 5)
```

Counties with the names "Crawford", "Jackson", and "Monroe" exist in all five Midwestern states.

### Question 3

```{r}

midwest |>
  select(county, state, popdensity, poptotal, area) |>
  filter(popdensity > 25000) |>
  arrange(desc(popdensity))
```

The county with the largest population is Cook county, Illinois, home to `r max(midwest$poptotal)` residents.

### Question 5

```{r}

midwest |>
  mutate(metro = ifelse(inmetro == 1, "Yes", "No")) |>
  count(state,metro == "Yes")
```

### Question 6

```{r}
#A
midwest |> 
  select(county, state, percbelowpoverty, percollege) |>
  filter(percbelowpoverty > 40 & percollege < 10)

#B 
midwest |> 
  select(county, state, percbelowpoverty, percollege) |>
  filter(percbelowpoverty < 20 & percollege > 40)

#C
midwest |> 
  select(county, state, percbelowpoverty, percollege) |>
  filter(percbelowpoverty > 40 & percollege < 10 |
         percbelowpoverty < 20 & percollege > 40)

#D & E

midwest |> 
  mutate(potential_outlier = ifelse(percbelowpoverty > 40 & percollege < 10 |
         percbelowpoverty < 20 & percollege > 40,
    "Yes", "No")
    ) |>
  select(county, state, percbelowpoverty, percollege, potential_outlier) |>
  ggplot( 
       aes(x = percollege, y = percbelowpoverty, 
           color = potential_outlier, shape = state)) + 
       geom_point() +
       labs(
         title = "Impacts of College Education on County Poverty, Extreme Cases",
         x = "College Educated(% Pop.)",
         y = "Below Poverty Line(% Pop.)",
         color = "Outlier?", 
         shape = "State"
       )

```

### Question 7

```{r}
#A

Total_population <- midwest |> 
  group_by(state) |>
  summarize(state_pop_total = sum(poptotal)) |>
  arrange(desc(state_pop_total))

#B

midwest |> 
  group_by(state) |> 
  summarize(state_pop_total = sum(poptotal)) |>
  mutate(state_pop_prop = state_pop_total/ sum(state_pop_total)) |>
  arrange(desc(state_pop_prop))





```

Illinois had the largest population of 11,430,602 residents, 27% of all Midwesterners. Wisconsin had the smallest populace, at 4,891,769 residents, just 11% of all Midwesterners.

### Question 8

```{r}

state_poverty <- midwest |>
  group_by(state) |>
  summarize(mean_percbelowpoverty = mean(percbelowpoverty,na.rm = TRUE))

state_poverty |>
  arrange(mean_percbelowpoverty)

```

Indiana has the lowest average percentage living below the poverty line while Michigan has the highest average percentage living below the poverty line.

## Part 2

### Question 9
